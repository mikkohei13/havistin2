{% extends "base.html" %}

{% block head %}
    <title>Lintuatlaksen tilastoja (biomi.org)</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    {% endblock %}

    {% block breadcrumb %}
        &raquo; Lintuatlas

{% endblock %}

{% block body %}

    <h1>Lintuatlaksen tilastoja ja apuvälineitä</h1>

    <p>Tällä sivustolla on Lintuatlaksen tuoreita tilastoja, perustuen Lajitietokeskuksen rajapintaan ja avoimeen dataan. Sensitiivisten lajien havainnot sekä käyttäjien karkeistamat havainnot tulevat mukaan viiveellä sekä karkeistuksen mukaisina. Mukana ei ole epätodennäköisiä pesimähavaintoja.</p>

    <div id="subnavi">
        <h3>Tulostettava atlasruudun maastolomake</h3>
        <form id="squareselection" action="" method="get">
            <input id="mode" type="hidden" value="squareform">
            <label id="square-label">
                Ruutu:
                <input type="text" id="square" name="square">
            </label>
            <input type="submit" value="Valitse"> <span>(esim. 668:338)</span>
        </form>
    </div>

    {{ html["collections_table"]|safe }}

    {{ html["breeding_certain"]|safe }}

    {{ html["breeding_probable"]|safe }}

    {{ html["recent_observers"]|safe }}

    {{ html["societies"]|safe }}

    {{ html["accuracy_table"]|safe }}

    <h3>Atlasruudut, joista eniten havaintoja (top 10)</h3>
    {{ html["squares"]|safe }}

    <h3>Atlasruudut, joista eniten tarkkoja havaintoja (top 10, tarkkuus < 1000 m)</h3>
    {{ html["accurate_squares"]|safe }}

    <div>
        <canvas id="cumulative_chart"></canvas>
    </div>

    <script type="text/javascript">
        json = '{{ html["cumulative_datechart_data_birdatlas"]|safe }}';
        birdatlas_data = JSON.parse(json);

        json = '{{ html["cumulative_datechart_data_trip"]|safe }}';
        trip_data = JSON.parse(json);

        json = '{{ html["cumulative_datechart_data_tiira"]|safe }}';
        tiira_data = JSON.parse(json);

        json = '{{ html["cumulative_datechart_data_inat"]|safe }}';
        inat_data = JSON.parse(json);

        const data = {
            datasets: [
                { 
                    data: birdatlas_data,
                    borderColor: '#FA5428',
                    label: "Vihko, lintuatlaslomake"
                },
                { 
                    data: trip_data,
                    borderColor: '#2691D9',
                    label: "Vihko, retkilomake"
                },
                { 
                    data: tiira_data,
                    borderColor: '#99019C',
                    label: "Tiira"
                },
                { 
                    data: inat_data,
                    borderColor: '#74AC00',
                    label: "iNaturalist"
                }
            ]
        };

        const config = {
            type: 'line',
            data: data,
            /*
            // Stacked, but without unique filler colors
            options: {
                scales: {
                    yAxes: {
                        stacked: true
                    }
                }
            }
            */
           options: {}
        };
        
        const myChart = new Chart(document.getElementById('cumulative_chart'), config);
    </script>

{% endblock %}
