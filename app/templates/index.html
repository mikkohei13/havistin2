{% extends "base.html" %}

{% block head %}
    <title>Lintuatlaksen tilastoja (biomi.org)</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    {% endblock %}

    {% block breadcrumb %}
        &raquo; Lintuatlas

{% endblock %}

{% block body %}

    <h1>Lintuatlaksen tilastoja ja apuvälineitä</h1>

    <h3>Tulostettava atlasruudun maastolomake</h3>
    <form id="squareselection" action="" method="get">
        <label id="square-label">
            Ruutu:
            <input type="text" id="square" name="square" placeholder="668:338">
        </label>
        <input type="submit" value="Valitse">
    </form>

    {{ html["collections_table"]|safe }}

    <div>
    <canvas id="myChart" style="width: 95%; height: 400px;"></canvas>
    </div>

    <script type="text/javascript">
        json = '{{ html["datechart_data_birdatlas"]|safe }}';
        birdatlas_data = JSON.parse(json);

        json = '{{ html["datechart_data_trip"]|safe }}';
        trip_data = JSON.parse(json);

        json = '{{ html["datechart_data_tiira"]|safe }}';
        tiira_data = JSON.parse(json);

        json = '{{ html["datechart_data_inat"]|safe }}';
        inat_data = JSON.parse(json);

        const data = {
            datasets: [
                { 
                    data: birdatlas_data,
                    borderColor: '#FA5428',
                    label: "Vihko, lintuatlaslomake"
                },
                { 
                    data: trip_data,
                    borderColor: '#2691D9',
                    label: "Vihko, retkilomake"
                },
                { 
                    data: tiira_data,
                    borderColor: '#99019C',
                    label: "Tiira"
                },
                { 
                    data: inat_data,
                    borderColor: '#74AC00',
                    label: "iNaturalist"
                }
            ]
        };

        const config = {
            type: 'line',
            data: data,
            options: {}
        };
        
        const ctx = document.getElementById('myChart');
        const myChart = new Chart(ctx, config);
    </script>

{% endblock %}
